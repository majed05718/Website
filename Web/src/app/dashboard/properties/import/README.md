# ุตูุญุฉ ุงุณุชูุฑุงุฏ ุงูุนูุงุฑุงุช ูู Excel

ุตูุญุฉ ูุชูุฏูุฉ ูุงุณุชูุฑุงุฏ ุงูุนูุงุฑุงุช ุจุดูู ูุฌูุน ูู ูููุงุช Excel ุฃู CSV ูุน ูุทุงุจูุฉ ุฐููุฉ ููุฃุนูุฏุฉ ูุงูุชุญูู ูู ุงูุจูุงูุงุช.

## ุงููููุฒุงุช

### 1. ุฑูุน ุงููููุงุช (File Upload)
- โ ุฏุนู ูููุงุช Excel (.xlsx, .xls)
- โ ุฏุนู ูููุงุช CSV (.csv)
- โ Drag & Drop
- โ ุนุฑุถ ุงุณู ุงูููู ูุญุฌูู
- โ ุฅููุงููุฉ ุญุฐู ุงูููู

### 2. ูุทุงุจูุฉ ุงูุฃุนูุฏุฉ ุงูุฐููุฉ (AI Column Mapping)
- โ ูุทุงุจูุฉ ุชููุงุฆูุฉ ููุฃุนูุฏุฉ ุจุงุณุชุฎุฏุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู
- โ ุฏุนู ุงูุฃุณูุงุก ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
- โ ูุณุจุฉ ุซูุฉ ูููุทุงุจูุฉ (Confidence Score)
- โ ุฅููุงููุฉ ุงูุชุนุฏูู ุงููุฏูู
- โ ุนูุงูุงุช ุจุตุฑูุฉ ูููุทุงุจูุงุช ุงูุตุญูุญุฉ ูุบูุฑ ุงููุคูุฏุฉ

### 3. ููุฎุต ุงูุชุญูู (Validation Summary)
- โ ุนุฏุฏ ุงูุตููู ุงูุฅุฌูุงูู
- โ ุนุฏุฏ ุงูุตููู ุงูุตุญูุญุฉ (ุฃุฎุถุฑ)
- โ ุนุฏุฏ ุงูุชุญุฐูุฑุงุช (ุฃุตูุฑ)
- โ ุนุฏุฏ ุงูุฃุฎุทุงุก (ุฃุญูุฑ)
- โ ุดุฑูุท ุชูุฏู ูููู
- โ ูุงุฆูุฉ ุชูุตูููุฉ ุจุงูุฃุฎุทุงุก ูุงูุชุญุฐูุฑุงุช

### 4. ูุนุงููุฉ ุงูุจูุงูุงุช (Data Preview)
- โ ุนุฑุถ ุฃูู 10 ุตููู
- โ ุชูููู ุงูุตููู ุญุณุจ ุงูุญุงูุฉ:
  - ๐ข ุฃุฎุถุฑ: ุจูุงูุงุช ุตุญูุญุฉ
  - ๐ก ุฃุตูุฑ: ุชุญุฐูุฑุงุช
  - ๐ด ุฃุญูุฑ: ุฃุฎุทุงุก
- โ ุฃููููุงุช ุชูุถูุญูุฉ ููู ุตู
- โ ุฑุณุงุฆู ุชูุตูููุฉ ููุฃุฎุทุงุก ูุงูุชุญุฐูุฑุงุช

### 5. ุดุฑูุท ุงูุชูุฏู (Import Progress)
- โ ูุณุจุฉ ุงูุฅูุฌุงุฒ ุงููุฆููุฉ
- โ ุนุฏุฏ ุงูุนูุงุฑุงุช ุงููุนุงูุฌุฉ / ุงูุฅุฌูุงูู
- โ ุชูุฏูุฑ ุงูููุช ุงููุชุจูู
- โ ุณุฑุนุฉ ุงูุงุณุชูุฑุงุฏ (ุนูุงุฑ/ุซุงููุฉ)
- โ ููุฎุต ุงููุฌุงุญ ูุงููุดู

## ุงูุจููุฉ ุงูุชูููุฉ

### ุงูููููุงุช (Components)

```
/components/properties/import/
โโโ ExcelUploader.tsx        # ุฑูุน ุงููููุงุช
โโโ ColumnMapper.tsx          # ูุทุงุจูุฉ ุงูุฃุนูุฏุฉ
โโโ DataPreview.tsx           # ูุนุงููุฉ ุงูุจูุงูุงุช
โโโ ValidationSummary.tsx     # ููุฎุต ุงูุชุญูู
โโโ ImportProgress.tsx        # ุดุฑูุท ุงูุชูุฏู
โโโ index.ts                  # Exports
```

### ุงูููุชุจุงุช ุงููุณุงุนุฏุฉ

```
/lib/excel/
โโโ parser.ts        # ุชุญููู Excel ู CSV
โโโ mapper.ts        # ูุทุงุจูุฉ ุงูุฃุนูุฏุฉ ุงูุฐููุฉ
โโโ validator.ts     # ุงูุชุญูู ูู ุงูุจูุงูุงุช
```

### ุงูุฃููุงุน (Types)

```
/types/excel.ts
โโโ ParsedExcelData
โโโ ExcelColumn
โโโ ExcelError
โโโ ExcelWarning
```

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุฑูุน ุงูููู
```typescript
// ุงููุณุชุฎุฏู ูุฑูุน ููู Excel ุฃู CSV
// ูุชู ุชุญูููู ุชููุงุฆูุงู
const parsedData = await parseExcelFile(file)
// ุฃู
const parsedData = await parseCSVFile(file)
```

### 2. ูุทุงุจูุฉ ุงูุฃุนูุฏุฉ
```typescript
// ูุทุงุจูุฉ ุชููุงุฆูุฉ
const mappings = autoMapColumns(parsedData.headers)

// ุงููุณุชุฎุฏู ููููู ุชุนุฏูู ุงููุทุงุจูุฉ ูุฏููุงู
```

### 3. ุงูุชุญูู ูู ุงูุจูุงูุงุช
```typescript
const { errors, warnings } = validateImportData(
  parsedData.data,
  mappings
)
```

### 4. ุงูุงุณุชูุฑุงุฏ
```typescript
const properties = transformToApiFormat(
  parsedData.data,
  mappings
)
await importProperties(properties)
```

## ุงูุญููู ุงููุฏุนููุฉ

### ุญููู ูุทููุจุฉ (Required)
- **ุงูุนููุงู** (title)
- **ููุน ุงูุนูุงุฑ** (property_type): ุดูุฉุ ูููุงุ ุฃุฑุถุ ุชุฌุงุฑู
- **ููุน ุงูุนุฑุถ** (listing_type): ุจูุนุ ุฅูุฌุงุฑ
- **ุงูุณุนุฑ** (price)

### ุญููู ุงุฎุชูุงุฑูุฉ (Optional)
- ุงููุตู (description)
- ุงููุณุงุญุฉ (area)
- ุบุฑู ุงูููู (bedrooms)
- ุฏูุฑุงุช ุงูููุงู (bathrooms)
- ุงููุฏููุฉ (city)
- ุงูุญู (district)
- ุงููููุน (location)
- ุงูุญุงูุฉ (status)

## API Endpoints

```typescript
// ุงุณุชูุฑุงุฏ ุงูุนูุงุฑุงุช
POST /api/properties/import/confirm
Body: { properties: Property[] }

// ุชูุฒูู ุงููุงูุจ
GET /api/properties/template

// ุชุตุฏูุฑ ุงูุนูุงุฑุงุช
GET /api/properties/export
```

## ุงูุฎุทูุงุช (Steps)

1. **ุฑูุน ุงูููู** (Upload)
2. **ุฑุจุท ุงูุฃุนูุฏุฉ** (Mapping)
3. **ูุนุงููุฉ** (Preview)
4. **ุงุณุชูุฑุงุฏ** (Importing) - ูุน progress bar
5. **ุงูุชูู** (Complete)

## ููุงุญุธุงุช

- ูุฏุนู RTL ุจุงููุงูู
- ูุณุชุฎุฏู shadcn/ui components
- ูุณุชุฎุฏู react-hook-form + zod ููููุงุฐุฌ
- ูุณุชุฎุฏู xlsx library ูุชุญููู Excel
- ูุณุชุฎุฏู papaparse ูุชุญููู CSV
- Loading states ูู ูู ุฎุทูุฉ
- Error handling ุดุงูู
- Toast notifications

## ุฃูุซูุฉ

### ูุซุงู ุนูู ููู Excel ุตุญูุญ

| ุงูุนููุงู | ููุน ุงูุนูุงุฑ | ููุน ุงูุนุฑุถ | ุงูุณุนุฑ | ุงููุณุงุญุฉ | ุบุฑู ุงูููู |
|---------|-----------|----------|-------|---------|----------|
| ุดูุฉ ูุงุฎุฑุฉ | ุดูุฉ | ุจูุน | 500000 | 200 | 3 |
| ูููุง ุนุตุฑูุฉ | ูููุง | ุฅูุฌุงุฑ | 8000 | 400 | 5 |

### ูุซุงู ุนูู ุงูุชุญุฐูุฑุงุช

- ููุน ุนูุงุฑ ุบูุฑ ูุนุฑูู โ ุณูุชู ุงุณุชุฎุฏุงู "ุฃุฎุฑู"
- ูุณุงุญุฉ ุตูุฑ ุฃู ุณุงูุจุฉ

### ูุซุงู ุนูู ุงูุฃุฎุทุงุก

- ุญูู ูุทููุจ ูุงุฑุบ
- ููุน ุนุฑุถ ุบูุฑ ุตุญูุญ
- ุณุนุฑ ุตูุฑ ุฃู ุณุงูุจ
- ูููุฉ ุบูุฑ ุฑูููุฉ ูู ุญูู ุฑููู

## ุงูุชุทููุฑ ุงููุณุชูุจูู

- [ ] ุฏุนู ุงุณุชูุฑุงุฏ ุงูุตูุฑ
- [ ] ุงุณุชูุฑุงุฏ ูุชุนุฏุฏ ุงูุฃูุฑุงู (Multiple sheets)
- [ ] ุชุตุฏูุฑ ุชูุฑูุฑ ุงูุฃุฎุทุงุก
- [ ] ุญูุธ mapping templates
- [ ] ูุนุงููุฉ ุงูุตูุฑ ูุจู ุงูุงุณุชูุฑุงุฏ
