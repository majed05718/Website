# ๐ฏ ููุฎุต ุงูุญู - ูุดููุฉ ุชุญููู ุตูุญุฉ Frontend

## ๐ ุงูุชุดุฎูุต

ุชู ุงูุชุดุงู ูุดููุชูู ุฑุฆูุณูุชูู:

### 1. ูุดููุฉ ุงูุจูุงุก โ
```
Error: Could not find a production build in the '.next' directory
```

**ุงูุชูุณูุฑ**: 
- Next.js ูุนูู ูู ูุถุนูู:
  - `next dev` โ ููุชุทููุฑ (Development)
  - `next start` โ ููุฅูุชุงุฌ (Production)
- ุนูุฏ ุงุณุชุฎุฏุงู `next start`ุ ูุฌุจ ุฃู ูููู ุงููุดุฑูุน **ูุจูู ูุณุจูุงู** ุจูุงุณุทุฉ `next build`
- ูุฌูุฏ `.next` ูุญุชูู ุนูู ุงููููุงุช ุงููุจููุฉ ุงูุฌุงูุฒุฉ ููุฅูุชุงุฌ

**ุงูุณุจุจ**: ูู ูุชู ุชุดุบูู `npm run build` ูุจู `npm start`

---

### 2. ูุดููุฉ NODE_ENV โ๏ธ
```
You are using a non-standard "NODE_ENV" value
```

**ุงูุชูุณูุฑ**:
- Next.js (ู Node.js ุจุดูู ุนุงู) ูุชููุน ููู ูุนููุฉ ูู `NODE_ENV`:
  - `production` โ
  - `development` โ
  - `test` โ
- ุฃู ูููุฉ ุฃุฎุฑู ูุซู `staging` ุฃู `prod` ุชุนุชุจุฑ **ุบูุฑ ููุงุณูุฉ**

**ุงูุณุจุจ**: ุงุณุชุฎุฏุงู ูููุฉ ูุซู `staging` ูู ููู `ecosystem.config.js`

---

## โ ุงูุญู ุงูุดุงูู

### ๐ ุงูุทุฑููุฉ ุงูุณุฑูุนุฉ (ููุตู ุจูุง)

```bash
# ุงูุงูุชูุงู ูููุฌูุฏ ุงูุฑุฆูุณู
cd /var/www/Website

# ุชุดุบูู ุณูุฑูุจุช ุงูุฅุตูุงุญ ุงูุชููุงุฆู
bash fix-frontend-production.sh
```

ูุฐุง ุงูุณูุฑูุจุช ุณูููู ุจู:
1. โ ุงูุชุญูู ูู ุงููุณุงุฑุงุช
2. โ ุญุฐู ุงูุจูุงุก ุงููุฏูู (ุฅู ูุฌุฏ)
3. โ ุงูุชุฃูุฏ ูู ุชุซุจูุช ุงูุญุฒู
4. โ ุชุนููู `NODE_ENV=production`
5. โ ุจูุงุก ุงููุดุฑูุน
6. โ ุงูุชุญูู ูู ุงูุจูุงุก
7. โ ุฅุนุงุฏุฉ ุชุดุบูู PM2
8. โ ุญูุธ ุฅุนุฏุงุฏุงุช PM2

---

### ๐ง ุงูุทุฑููุฉ ุงููุฏููุฉ

ุฅุฐุง ููุช ุชูุถู ุงูุชุญูู ุงููุงูู:

#### ุงูุฎุทูุฉ 1: ุจูุงุก ุงููุดุฑูุน

```bash
# ุงูุงูุชูุงู ููุฌูุฏ Frontend
cd /var/www/Website/Web

# ุชุนููู ุจูุฆุฉ ุงูุฅูุชุงุฌ
export NODE_ENV=production

# ุญุฐู ุงูุจูุงุก ุงููุฏูู (ุงุฎุชูุงุฑู)
rm -rf .next

# ุจูุงุก ุงููุดุฑูุน
npm run build
```

**โณ ุงูููุช ุงููุชููุน**: 2-5 ุฏูุงุฆู

#### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุงูุจูุงุก

```bash
# ุงูุชุญูู ูู ูุฌูุฏ BUILD_ID
ls -la .next/BUILD_ID

# ุนุฑุถ BUILD_ID
cat .next/BUILD_ID
```

ูุฌุจ ุฃู ุชุฑู ููู `BUILD_ID` ููุฌูุฏ.

#### ุงูุฎุทูุฉ 3: ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช PM2

ุชุญุฑูุฑ ููู `/var/www/Website/ecosystem.config.js`:

```javascript
module.exports = {
  apps: [
    {
      name: 'frontend',
      cwd: './Web',
      script: 'node_modules/next/dist/bin/next',
      args: 'start -p 8088',
      env: {
        NODE_ENV: 'production',  // โ ุชุฃูุฏ ูู ูุฐุง ุงูุณุทุฑ
        PORT: 8088,
      },
    },
  ],
};
```

#### ุงูุฎุทูุฉ 4: ุฅุนุงุฏุฉ ุชุดุบูู PM2

```bash
# ุงูุนูุฏุฉ ูููุฌูุฏ ุงูุฑุฆูุณู
cd /var/www/Website

# ุฅููุงู ุฌููุน ุงูุชุทุจููุงุช
pm2 stop all

# ุญุฐู ุงูุชุทุจููุงุช ุงููุฏููุฉ
pm2 delete all

# ุชุดุบูู ุงูุฅุนุฏุงุฏุงุช ุงูุฌุฏูุฏุฉ
pm2 start ecosystem.config.js

# ุญูุธ ุงูุฅุนุฏุงุฏุงุช
pm2 save
```

#### ุงูุฎุทูุฉ 5: ุงูุชุญูู ูู ุงููุชูุฌุฉ

```bash
# ุนุฑุถ ุญุงูุฉ ุงูุชุทุจููุงุช
pm2 list

# ูุฑุงูุจุฉ ุงูุณุฌูุงุช
pm2 logs frontend
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**:
```
โ Ready in 500ms
- Local:    http://localhost:8088
- Network:  http://0.0.0.0:8088
```

---

## ๐ ุฃุฏูุงุช ุงููุญุต ูุงููุฑุงูุจุฉ

### ุณูุฑูุจุช ุงููุญุต ุงูุณุฑูุน

```bash
bash check-frontend-status.sh
```

ูุฐุง ุงูุณูุฑูุจุช ููุญุต:
- โ ูุฌูุฏ ูุฌูุฏ ุงููุดุฑูุน
- โ ูุฌูุฏ `package.json`
- โ ุชุซุจูุช `node_modules`
- โ ูุฌูุฏ ูุฌูุฏ `.next` ู `BUILD_ID`
- โ ุญุงูุฉ PM2
- โ ุญุงูุฉ ุงูุจูุฑุช 8088
- โ ูููุฉ `NODE_ENV`
- โ ูุฌูุฏ `ecosystem.config.js`

### ุฃูุงูุฑ PM2 ุงููููุฏุฉ

```bash
# ูุงุฆูุฉ ุงูุชุทุจููุงุช
pm2 list

# ุงูุณุฌูุงุช ุงููุจุงุดุฑุฉ
pm2 logs frontend

# ุขุฎุฑ 50 ุณุทุฑ ูู ุงูุณุฌูุงุช
pm2 logs frontend --lines 50

# ุฅุนุงุฏุฉ ุชุดุบูู
pm2 restart frontend

# ุฅููุงู
pm2 stop frontend

# ูุนูููุงุช ุชูุตูููุฉ
pm2 show frontend

# ูุฑุงูุจุฉ ุงูููุงุฑุฏ
pm2 monit
```

---

## ๐จ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ุงููุดููุฉ: ุงูุจูุงุก ููุดู

**ุงูุฃุนุฑุงุถ**:
```
npm ERR! Build failed
```

**ุงูุญู**:
```bash
cd /var/www/Website/Web

# ุชูุธูู ูุงูู
rm -rf .next node_modules package-lock.json

# ุฅุนุงุฏุฉ ุงูุชุซุจูุช
npm install

# ุฅุนุงุฏุฉ ุงูุจูุงุก
npm run build
```

---

### ุงููุดููุฉ: PM2 ูุนูุฏ ุงูุชุดุบูู ุจุงุณุชูุฑุงุฑ

**ุงูุฃุนุฑุงุถ**:
```
PM2 | App [frontend] exited with code [1]
PM2 | App [frontend] starting in -fork mode-
```

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ**:
1. ุงููุดุฑูุน ุบูุฑ ูุจูู
2. ุงูุจูุฑุช ูุดุบูู
3. ุฎุทุฃ ูู ุงูููุฏ

**ุงูุญู**:
```bash
# ูุญุต ุงูุณุฌูุงุช
pm2 logs frontend --lines 100

# ุงูุชุฃูุฏ ูู ุงูุจูุงุก
ls -la /var/www/Website/Web/.next/BUILD_ID

# ูุญุต ุงูุจูุฑุช
lsof -i :8088
```

---

### ุงููุดููุฉ: ุงูุจูุฑุช ูุดุบูู

**ุงูุฃุนุฑุงุถ**:
```
Error: listen EADDRINUSE: address already in use :::8088
```

**ุงูุญู**:
```bash
# ูุนุฑูุฉ ุงูุนูููุฉ ุงูุชู ุชุณุชุฎุฏู ุงูุจูุฑุช
lsof -i :8088

# ุฃู
netstat -tulpn | grep 8088

# ุฅููุงู ุงูุนูููุฉ (ุงุณุชุจุฏู PID ุจุงูุฑูู ุงููุนูู)
kill -9 [PID]

# ุฅุนุงุฏุฉ ุชุดุบูู PM2
pm2 restart frontend
```

---

### ุงููุดููุฉ: ุตูุงุญูุงุช ุงููููุงุช

**ุงูุฃุนุฑุงุถ**:
```
EACCES: permission denied
```

**ุงูุญู**:
```bash
cd /var/www/Website

# ุชุบููุฑ ุงููุงูู
sudo chown -R $USER:$USER Web/

# ุชุบููุฑ ุงูุตูุงุญูุงุช
chmod -R 755 Web/

# ุฅุนุงุฏุฉ ุงููุญุงููุฉ
cd Web
npm run build
```

---

## ๐ ุงููููุงุช ุงููุณุงุนุฏุฉ

ุชู ุฅูุดุงุก ุงููููุงุช ุงูุชุงููุฉ ููุณุงุนุฏุชู:

| ุงูููู | ุงููุตู |
|-------|-------|
| `fix-frontend-production.sh` | ุณูุฑูุจุช ุฅุตูุงุญ ุชููุงุฆู ุดุงูู |
| `check-frontend-status.sh` | ุณูุฑูุจุช ูุญุต ุงูุญุงูุฉ |
| `FRONTEND_FIX_GUIDE.md` | ุฏููู ุดุงูู ุจุงูุนุฑุจู |
| `ecosystem.config.production.js` | ููู ุฅุนุฏุงุฏุงุช PM2 ูุญุณูู |
| `ุงูุญู_ุงูุณุฑูุน_ูููุฑููุช_ุงูุฏ.txt` | ููุฎุต ุณุฑูุน ุจุงูุนุฑุจู |
| `SOLUTION_SUMMARY_AR.md` | ูุฐุง ุงูููู |

---

## ๐ ููู ุฃุนูู

### ููุงุฐุง ูุฌุจ ุจูุงุก ุงููุดุฑูุนุ

Next.js ูููู ุจุนูููุงุช ูุนูุฏุฉ ุฃุซูุงุก ุงูุจูุงุก:

1. **ุชุญุณูู ุงูููุฏ**: ุชุตุบูุฑ JavaScript ู CSS
2. **ุชูุณูู ุงูููุฏ**: ุฅูุดุงุก ุญุฒู ูููุตูุฉ ููู ุตูุญุฉ
3. **ุงูุชุตููุฑ ุงููุณุจู**: ุฅูุดุงุก HTML ุซุงุจุช ููุตูุญุงุช
4. **ุชุญุณูู ุงูุตูุฑ**: ุถุบุท ูุชุญุณูู ุงูุตูุฑ
5. **ุฅูุดุงุก Route Manifest**: ุฎุฑูุทุฉ ูููุณุงุฑุงุช

ูุชูุฌุฉ ูุฐู ุงูุนูููุงุช ุชูุญูุธ ูู ูุฌูุฏ `.next`ุ ููู ูุง ูุณุชุฎุฏูู `next start`.

### ููุงุฐุง NODE_ENV ูููุ

ูููุฉ `NODE_ENV` ุชุคุซุฑ ุนูู:

1. **ุงูุชุญุณููุงุช**: ูู `production` ูุชู ุชูุนูู ุฌููุน ุงูุชุญุณููุงุช
2. **ุญุฌู ุงูุญุฒู**: ูุชู ุฅุฒุงูุฉ ููุฏ ุงูุชุทููุฑ ูู `production`
3. **ุงูุชุฎุฒูู ุงููุคูุช**: ุณููู ูุฎุชูู ููู caching
4. **ุงูุฑุณุงุฆู**: ุฅุฎูุงุก ุฑุณุงุฆู ุงูุชุทููุฑ ูู `production`
5. **ุงูุฃุฏุงุก**: ุชุญุณููุงุช ุฅุถุงููุฉ ูู `production`

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

ูุจู ุงูุงุนุชูุงุฏ ุนูู ุงูุชุทุจููุ ุชุฃูุฏ ูู:

- [ ] ูุฌูุฏ `.next` ููุฌูุฏ
- [ ] ููู `.next/BUILD_ID` ููุฌูุฏ
- [ ] `pm2 list` ูุธูุฑ `frontend` ูู ุญุงูุฉ `online` ๐ข
- [ ] `pm2 logs frontend` ูุง ูุธูุฑ ุฃุฎุทุงุก
- [ ] `NODE_ENV=production` ูู ุฅุนุฏุงุฏุงุช PM2
- [ ] ุงููุชุตูุญ ููุชุญ ุงูุตูุญุฉ ุจุฏูู ุฃุฎุทุงุก
- [ ] ูุง ุชูุฌุฏ ุฑุณุงูุฉ "non-standard NODE_ENV"

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุจุนุฏ ุญู ุงููุดููุฉ:

### 1. ุฅูุดุงุก ุณูุฑูุจุช ูุดุฑ

```bash
#!/bin/bash
# deploy.sh

cd /var/www/Website/Web
git pull origin main
npm install
npm run build
pm2 restart frontend
```

### 2. ุฅุนุฏุงุฏ Webhook ูููุดุฑ ุงูุชููุงุฆู

ููููู ุงุณุชุฎุฏุงู GitHub Actions ุฃู GitLab CI/CD ููุดุฑ ุงูุชุบููุฑุงุช ุชููุงุฆูุงู.

### 3. ูุฑุงูุจุฉ ุงูุฃุฏุงุก

```bash
# ุชุซุจูุช PM2 Plus ูููุฑุงูุจุฉ ุงููุชูุฏูุฉ
pm2 link [secret-key] [public-key]
```

### 4. ุงููุณุฎ ุงูุงุญุชูุงุทู

```bash
# ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุฅุนุฏุงุฏุงุช PM2
pm2 save

# ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงูุจูุฆุฉ
pm2 env frontend > frontend-env-backup.txt
```

---

## ๐ ููุฏุนู ุงูุฅุถุงูู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู ุจุนุฏ ุงุชุจุงุน ูุฐุง ุงูุฏููู:

1. **ูุญุต ุงูุณุฌูุงุช ุงููุงููุฉ**:
   ```bash
   pm2 logs frontend --lines 200 > frontend-logs.txt
   cat frontend-logs.txt
   ```

2. **ูุญุต ูููุงุช ุงููุธุงู**:
   ```bash
   df -h  # ูุญุต ุงููุณุงุญุฉ
   free -m  # ูุญุต ุงูุฐุงูุฑุฉ
   ```

3. **ุฅุนุงุฏุฉ ุชุซุจูุช ูุงููุฉ**:
   ```bash
   cd /var/www/Website/Web
   rm -rf node_modules .next package-lock.json
   npm install
   npm run build
   pm2 restart frontend
   ```

---

## ๐ ุงูุฎูุงุตุฉ

ุงููุดููุฉ ุงูุฑุฆูุณูุฉ ูุงูุช:
- โ ุนุฏู ุจูุงุก ุงููุดุฑูุน ูุจู ุงูุชุดุบูู
- โ ุงุณุชุฎุฏุงู ูููุฉ ุบูุฑ ููุงุณูุฉ ูู NODE_ENV

ุงูุญู:
- โ ุชุดุบูู `npm run build`
- โ ุชุนููู `NODE_ENV=production`
- โ ุฅุนุงุฏุฉ ุชุดุบูู PM2

**ุงูููุช ุงููุชููุน ููุญู**: 5-10 ุฏูุงุฆู

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 2025-11-10  
**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุชุทุจูู
